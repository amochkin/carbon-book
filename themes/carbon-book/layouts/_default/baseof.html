{{/* Base layout: keep all document-level and structural wrappers here to avoid unclosed tags in partials. */}}
<!doctype html>
<html lang="{{ .Site.LanguageCode }}">
  <head>
    <title>{{ .Title }}</title>
    <meta charset="UTF-8" />
    <meta name="theme-color" content='{{ .Site.Params.header | default "#354F52" }}' />
    <meta name="apple-mobile-web-app-title" content="{{ .Title }}" />
    {{ if .Site.Params.instanaKey }}
    <script>
      (function (s, t, a, n) {
        s[t] || ((s[t] = a), (n = (s[a] = function () { n.q.push(arguments); })), (n.q = []), (n.v = 2), (n.l = 1 * new Date()));
      })(window, 'InstanaEumObject', 'ineum');
      ineum('reportingUrl', 'https://eum-coral-saas.instana.io');
      ineum('key', '{{ .Site.Params.instanaKey }}');
      ineum('trackSessions');
    </script>
    <script defer crossorigin="anonymous" src="https://eum.instana.io/eum.min.js"></script>
    {{ end }}
    <link rel="stylesheet" href="https://1.www.s81c.com/common/carbon/web-components/tag/v2/latest/themes.css" />
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/tag/v2/latest/ui-shell.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/tag/v2/latest/content-switcher.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/tag/v2/latest/skip-to-content.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/tag/v2/latest/tag.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.27.2/search.min.js"></script>
    {{ if .Site.Params.favicon }}
    <link rel="icon" href="{{ .Site.Params.favicon | absURL }}" />
    <link rel="shortcut icon" href="{{ .Site.Params.favicon | absURL }}" />
    {{ end }}
    {{ if .Site.Params.faviconSvg }}
    <link rel="icon" type="image/svg+xml" href="{{ .Site.Params.faviconSvg | absURL }}" />
    {{ end }}
    {{ if .Site.Params.siteicon }}
    <meta name="twitter:image" property="og:image" content="{{ .Site.Params.siteicon | absURL }}" />
    <link rel="apple-touch-icon" href="{{ .Site.Params.siteicon | absURL }}" />
    {{ end }}
    {{ partial "css" . }}
    {{ partial "js" . }}
    {{ hugo.Generator }}
    {{ template "_internal/opengraph.html" . }}
    <style>
      @media (min-width: 66rem) {
        .cds-hugo-carbon--container .cds--grid { padding-left: 2rem; padding-right: 2rem; }
      }
      h3 { margin-bottom: 1rem; }
    </style>
  </head>
  <body class='cds-theme-zone-{{ if isset .Site.Params "cdstheme" }}{{ .Site.Params.cdstheme }}{{ else }}g100{{ end }} {{ .Site.Params.build }}'>
    {{ partial "body-open" . }}
    <cds-skip-to-content href="#main-content" role="navigation" aria-label="Skip to main content"></cds-skip-to-content>
    <div class="cds-theme-zone-g90">
      {{ partial "header" . }}
    </div>
    <div id="main-content" name="main-content" data-floating-menu-container="" class="cds--body cds-hugo-carbon--container" role="none">
      <main class="cds--content cds-hugo-carbon--ui-shell-content">
        <div class="cds--grid">
          <div class="cds--row">
            <div class="cds--col-lg-12">
              {{ block "main" . }}
                {{ .Content }}
              {{ end }}
            </div>
          </div>
        </div>
      </main>
      {{ partial "side-nav.html" . }}
    </div>
    <script src="{{ "pagefind/pagefind-ui.js" | relURL }}"></script>
    {{ if isset .Site.Params "darktheme" }}
    <script type="text/javascript">
      function setTheme(themeName) { document.body.className = themeName; }
      function selectTheme() {
        const prefersDarkTheme = window.matchMedia('(prefers-color-scheme: dark)');
        if (prefersDarkTheme.matches) { setTheme('cds-theme-zone-{{ .Site.Params.darktheme }}'); }
        const prefersLightTheme = window.matchMedia('(prefers-color-scheme: light)');
        if (prefersLightTheme.matches) { setTheme('cds-theme-zone-{{ .Site.Params.lighttheme }}'); }
      }
      selectTheme();
      window.matchMedia('(prefers-color-scheme: dark)').onchange = selectTheme;
    </script>
    {{ end }}
    {{ if .Site.Params.search }}
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        new PagefindUI({ element: "#search", showSubResults: true, resetStyles: false, showImages: false });
      });
    </script>
    {{ end }}
  </body>
</html>
